const { GET_DB } = require("../config/DB");

/**
 * Kiểm tra trùng lịch trong MongoDB
 */
async function checkConflict(carId, startDate, endDate) {
  const db = GET_DB();

  return await db.collection("booking").findOne({
    carId,
    $and: [{ startDate: { $lte: endDate } }, { endDate: { $gte: startDate } }],
  });
}

/**
 * Lưu booking
 */
async function createBooking(booking) {
  const db = GET_DB();
  return await db.collection("booking").insertOne(booking);
}

module.exports = {
  checkConflict,
  createBooking,
};
